<<<<<<< Updated upstream
points(Credit$Rating,Credit$Balance, pch = 16, col = cat)
text(tree.credit, cex=0.8)
partition.tree(tree.credit, label = "", add = FALSE)
mycol <- c(rgb(0, 0, 250, max = 255, alpha = 50, names = "blue50"),
rgb(0, 250, 0, max = 255, alpha = 50, names = "green50"),
rgb(250, 0, 0, max = 255, alpha = 50, names = "red"),
rgb(255, 255,0 , max = 255, alpha = 50, names = "yellow50"))
points(Credit$Rating,Credit$Balance, pch = 16, col = cat)
legend("bottomright", legend = "Income", pch = 16, col = mycol, bty = "n")
mycol <- c(rgb(0, 0, 250, max = 255, alpha = 50, names = "blue50"),
rgb(0, 250, 0, max = 255, alpha = 50, names = "green50"),
rgb(250, 0, 0, max = 255, alpha = 50, names = "red"),
rgb(255, 255,0 , max = 255, alpha = 50, names = "yellow50"))
points(Credit$Rating,Credit$Balance, pch = 16, col = mycol)
legend("bottomright", legend = "Income", pch = 16, col = mycol, bty = "n")
text(tree.credit, cex=0.8)
partition.tree(tree.credit, label = "", add = FALSE)
mycol <- c(rgb(0, 0, 250, max = 255, alpha = 50, names = "blue50"),
rgb(0, 250, 0, max = 255, alpha = 50, names = "green50"),
rgb(250, 0, 0, max = 255, alpha = 50, names = "red"),
rgb(255, 255,0 , max = 255, alpha = 50, names = "yellow50"))
points(Credit$Rating,Credit$Balance, pch = 16, col = mycol)
legend("bottomright", legend = "Income", pch = 16, col = mycol, bty = "n")
points(Credit$Rating,Credit$Balance, pch = 16, col = mycol[cat])
partition.tree(tree.credit, label = "", add = FALSE)
mycol <- c(rgb(0, 0, 250, max = 255, alpha = 50, names = "blue50"),
rgb(0, 250, 0, max = 255, alpha = 50, names = "green50"),
rgb(250, 0, 0, max = 255, alpha = 50, names = "red"),
rgb(255, 255,0 , max = 255, alpha = 50, names = "yellow50"))
points(Credit$Rating,Credit$Balance, pch = 16, col = mycol[cat])
legend("bottomright", legend = "Income", pch = 16, col = mycol, bty = "n")
mycol <- c(rgb(0, 0, 250, max = 255, alpha = 50, names = "blue50"),
rgb(0, 250, 0, max = 255, alpha = 50, names = "green50"),
rgb(250, 0, 0, max = 255, alpha = 50, names = "red"),
rgb(255, 193,69 , max = 255, alpha = 50, names = "yellow50"))
text(tree.credit, cex=0.8)
partition.tree(tree.credit, label = "", add = FALSE)
mycol <- c(rgb(0, 0, 250, max = 255, alpha = 50, names = "blue50"),
rgb(0, 250, 0, max = 255, alpha = 50, names = "green50"),
rgb(250, 0, 0, max = 255, alpha = 50, names = "red"),
rgb(255, 193,69 , max = 255, alpha = 50, names = "yellow50"))
points(Credit$Rating,Credit$Balance, pch = 16, col = mycol[cat])
legend("bottomright", legend = "Income", pch = 16, col = mycol, bty = "n")
mycol <- c(rgb(0, 0, 250, max = 255, alpha = 50, names = "blue50"),
rgb(0, 250, 0, max = 255, alpha = 50, names = "green50"),
rgb(250, 0, 0, max = 255, alpha = 50, names = "red"),
rgb(255, 193,69 , max = 255, alpha = 100, names = "yellow50"))
points(Credit$Rating,Credit$Balance, pch = 16, col = mycol[cat])
mycol <- c(rgb(0, 0, 250, max = 255, alpha = 50, names = "blue50"),
rgb(100, 181, 83, max = 255, alpha = 50, names = "green50"),
rgb(250, 0, 0, max = 255, alpha = 50, names = "red"),
rgb(255, 193,69 , max = 255, alpha = 100, names = "yellow50"))
points(Credit$Rating,Credit$Balance, pch = 16, col = mycol[cat])
legend("bottomright", legend = "Income", pch = 16, col = mycol, bty = "n")
text(tree.credit, cex=0.8)
partition.tree(tree.credit, label = "", add = FALSE)
mycol <- c(rgb(0, 0, 250, max = 255, alpha = 50, names = "blue50"),
rgb(100, 181, 83, max = 255, alpha = 50, names = "green50"),
rgb(250, 0, 0, max = 255, alpha = 50, names = "red"),
rgb(255, 193,69 , max = 255, alpha = 100, names = "yellow50"))
points(Credit$Rating,Credit$Balance, pch = 16, col = mycol[cat])
legend("bottomright", legend = "Income", pch = 16, col = mycol, bty = "n")
partition.tree(tree.credit, label = "", add = FALSE)
mycol <- c(rgb(0, 0, 250, max = 255, alpha = 100, names = "blue50"),
rgb(100, 181, 83, max = 255, alpha = 100, names = "green50"),
rgb(250, 0, 0, max = 255, alpha = 100, names = "red"),
rgb(255, 193,69 , max = 255, alpha = 100, names = "yellow50"))
points(Credit$Rating,Credit$Balance, pch = 16, col = mycol[cat])
legend("bottomright", legend = "Income", pch = 16, col = mycol, bty = "n")
summary(Credit$Income)
legend("bottomright", legend = c("0 - 21", "21 - 33", "33 - 57","57 - 186"), pch = 16, col = mycol[cat], bty = "n")
partition.tree(tree.credit, label = "", add = FALSE)
mycol <- c(rgb(0, 0, 250, max = 255, alpha = 100, names = "blue50"),
rgb(100, 181, 83, max = 255, alpha = 100, names = "green50"),
rgb(250, 0, 0, max = 255, alpha = 100, names = "red"),
rgb(255, 193,69 , max = 255, alpha = 100, names = "yellow50"))
points(Credit$Rating,Credit$Balance, pch = 16, col = mycol[cat])
legend("bottomright", legend = c("0 - 21", "21 - 33", "33 - 57","57 - 186"), pch = 16, col = mycol, bty = "n")
?legend
legend("bottomright", title = "Income",legend = c("0 - 21", "21 - 33", "33 - 57","57 - 186"), pch = 16, col = mycol, bty = "n")
mycol <- c(rgb(255, 193,69, max = 255, alpha = 100, names = "blue50"),
rgb(245, 143, 42, max = 255, alpha = 100, names = "green50"),
rgb(250, 0, 0, max = 255, alpha = 100, names = "red"),
rgb(255, 193,69 , max = 255, alpha = 100, names = "yellow50"))
points(Credit$Rating,Credit$Balance, pch = 16, col = mycol[cat])
partition.tree(tree.credit, label = "", add = FALSE)
mycol <- c(rgb(255, 193,69, max = 255, alpha = 100, names = "blue50"),
rgb(245, 143, 42, max = 255, alpha = 100, names = "green50"),
rgb(250, 0, 0, max = 255, alpha = 100, names = "red"),
rgb(255, 193,69 , max = 255, alpha = 100, names = "yellow50"))
points(Credit$Rating,Credit$Balance, pch = 16, col = mycol[cat])
legend("bottomright", title = "Income",legend = c("0 - 21", "21 - 33", "33 - 57","57 - 186"), pch = 16, col = mycol, bty = "n")
mycol <- c(rgb(255, 193,69, max = 255, alpha = 100, names = "blue50"),
rgb(255, 102, 25, max = 255, alpha = 100, names = "green50"),
rgb(250, 0, 0, max = 255, alpha = 100, names = "red"),
rgb(255, 193,69 , max = 255, alpha = 100, names = "yellow50"))
{
plot(tree.credit)
text(tree.credit, cex=0.8)
partition.tree(tree.credit, label = "", add = FALSE)
points(Credit$Rating,Credit$Balance, pch = 16, col = mycol[cat])
legend("bottomright", title = "Income",legend = c("0 - 21", "21 - 33", "33 - 57","57 - 186"), pch = 16, col = mycol, bty = "n")
}
mycol <- c(rgb(255, 193,69, max = 255, alpha = 100, names = "blue50"),
rgb(255, 102, 25, max = 255, alpha = 100, names = "green50"),
rgb(255, 0, 0, max = 255, alpha = 100, names = "red"),
rgb(102, 0,0 , max = 255, alpha = 100, names = "yellow50"))
{
plot(tree.credit)
text(tree.credit, cex=0.8)
partition.tree(tree.credit, label = "", add = FALSE)
points(Credit$Rating,Credit$Balance, pch = 16, col = mycol[cat])
legend("bottomright", title = "Income",legend = c("0 - 21", "21 - 33", "33 - 57","57 - 186"), pch = 16, col = mycol, bty = "n")
}
mycol <- c(rgb(255, 193,69, max = 255, alpha = 100, names = "blue50"),
rgb(255, 102, 25, max = 255, alpha = 100, names = "green50"),
rgb(255, 0, 0, max = 255, alpha = 100, names = "red"),
rgb(153, 5,0 , max = 255, alpha = 100, names = "yellow50"))
mycol <- c(rgb(255, 193,69, max = 255, alpha = 100, names = "blue50"),
rgb(255, 102, 25, max = 255, alpha = 100, names = "green50"),
rgb(255, 0, 0, max = 255, alpha = 100, names = "red"),
rgb(153, 25,0 , max = 255, alpha = 100, names = "yellow50"))
{
plot(tree.credit)
text(tree.credit, cex=0.8)
partition.tree(tree.credit, label = "", add = FALSE)
points(Credit$Rating,Credit$Balance, pch = 16, col = mycol[cat])
legend("bottomright", title = "Income",legend = c("0 - 21", "21 - 33", "33 - 57","57 - 186"), pch = 16, col = mycol, bty = "n")
}
mycol <- c(rgb(255, 193,69, max = 255, alpha = 100, names = "blue50"),
rgb(255, 102, 25, max = 255, alpha = 100, names = "green50"),
rgb(255, 0, 0, max = 255, alpha = 100, names = "red"),
rgb(153, 25,0 , max = 255, alpha = 100, names = "yellow50"))
{
plot(tree.credit)
text(tree.credit, cex=0.8)
partition.tree(tree.credit, label = "", add = FALSE)
points(Credit$Rating,Credit$Balance, pch = 16, col = mycol[cat])
legend("bottomright", title = "Income",legend = c("0 - 21", "21 - 33", "33 - 57","57 - 186"), pch = 16, col = mycol, bty = "n")
}
mycol <- c(rgb(255, 193,69, max = 255, alpha = 100, names = "blue50"),
rgb(255, 102, 25, max = 255, alpha = 100, names = "green50"),
rgb(255, 0, 0, max = 255, alpha = 100, names = "red"),
rgb(166, 27,0 , max = 255, alpha = 100, names = "yellow50"))
{
plot(tree.credit)
text(tree.credit, cex=0.8)
partition.tree(tree.credit, label = "", add = FALSE)
points(Credit$Rating,Credit$Balance, pch = 16, col = mycol[cat])
legend("bottomright", title = "Income",legend = c("0 - 21", "21 - 33", "33 - 57","57 - 186"), pch = 16, col = mycol, bty = "n")
}
mycol <- c(rgb(255, 193,69, max = 255, alpha = 100, names = "blue50"),
rgb(255, 102, 25, max = 255, alpha = 100, names = "green50"),
rgb(255, 0, 0, max = 255, alpha = 100, names = "red"),
rgb(166, 27,0 , max = 255, alpha = 100, names = "yellow50"))
{
plot(tree.credit)
text(tree.credit, cex=0.8)
partition.tree(tree.credit, label = "", add = FALSE)
points(Credit$Rating,Credit$Balance, pch = 16, col = mycol[cat])
legend("bottomright", title = "Income",legend = c("0 - 21", "21 - 33", "33 - 57","57 - 186"), pch = 16, col = mycol, bty = "n")
}
mycol <- c(rgb(255, 193,69, max = 255, alpha = 100, names = "blue50"),
rgb(255, 102, 25, max = 255, alpha = 100, names = "green50"),
rgb(255, 0, 0, max = 255, alpha = 100, names = "red"),
rgb(0, 27,0 , max = 255, alpha = 100, names = "yellow50"))
{
plot(tree.credit)
text(tree.credit, cex=0.8)
partition.tree(tree.credit, label = "", add = FALSE)
points(Credit$Rating,Credit$Balance, pch = 16, col = mycol[cat])
legend("bottomright", title = "Income",legend = c("0 - 21", "21 - 33", "33 - 57","57 - 186"), pch = 16, col = mycol, bty = "n")
}
mycol <- c(rgb(255, 193,69, max = 255, alpha = 100, names = "blue50"),
rgb(255, 102, 25, max = 255, alpha = 100, names = "green50"),
rgb(255, 0, 0, max = 255, alpha = 100, names = "red"),
rgb(201, 33,0 , max = 255, alpha = 100, names = "yellow50"))
{
plot(tree.credit)
text(tree.credit, cex=0.8)
partition.tree(tree.credit, label = "", add = FALSE)
points(Credit$Rating,Credit$Balance, pch = 16, col = mycol[cat])
legend("bottomright", title = "Income",legend = c("0 - 21", "21 - 33", "33 - 57","57 - 186"), pch = 16, col = mycol, bty = "n")
}
mycol <- c(rgb(255, 193,69, max = 255, alpha = 100, names = "blue50"),
rgb(255, 102, 25, max = 255, alpha = 100, names = "green50"),
rgb(255, 0, 0, max = 255, alpha = 100, names = "red"),
rgb(201, 33,0 , max = 255, alpha = 130, names = "yellow50"))
{
plot(tree.credit)
text(tree.credit, cex=0.8)
partition.tree(tree.credit, label = "", add = FALSE)
points(Credit$Rating,Credit$Balance, pch = 16, col = mycol[cat])
legend("bottomright", title = "Income",legend = c("0 - 21", "21 - 33", "33 - 57","57 - 186"), pch = 16, col = mycol, bty = "n")
}
mycol <- c(rgb(255, 227,115, max = 255, alpha = 100, names = "blue50"),
rgb(255, 102, 25, max = 255, alpha = 100, names = "green50"),
rgb(255, 0, 0, max = 255, alpha = 100, names = "red"),
rgb(201, 33,0 , max = 255, alpha = 130, names = "yellow50"))
{
plot(tree.credit)
text(tree.credit, cex=0.8)
partition.tree(tree.credit, label = "", add = FALSE)
points(Credit$Rating,Credit$Balance, pch = 16, col = mycol[cat])
legend("bottomright", title = "Income",legend = c("0 - 21", "21 - 33", "33 - 57","57 - 186"), pch = 16, col = mycol, bty = "n")
}
mycol <- c(rgb(255, 227,115, max = 255, alpha = 130, names = "blue50"),
rgb(255, 102, 25, max = 255, alpha = 100, names = "green50"),
rgb(255, 0, 0, max = 255, alpha = 100, names = "red"),
rgb(201, 33,0 , max = 255, alpha = 130, names = "yellow50"))
{
plot(tree.credit)
text(tree.credit, cex=0.8)
partition.tree(tree.credit, label = "", add = FALSE)
points(Credit$Rating,Credit$Balance, pch = 16, col = mycol[cat])
legend("bottomright", title = "Income",legend = c("0 - 21", "21 - 33", "33 - 57","57 - 186"), pch = 16, col = mycol, bty = "n")
}
mycol <- c(rgb(255, 227,115, max = 255, alpha = 130, names = "blue50"),
rgb(255, 185, 64, max = 255, alpha = 100, names = "green50"),
rgb(255, 0, 0, max = 255, alpha = 100, names = "red"),
rgb(201, 33,0 , max = 255, alpha = 130, names = "yellow50"))
{
plot(tree.credit)
text(tree.credit, cex=0.8)
partition.tree(tree.credit, label = "", add = FALSE)
points(Credit$Rating,Credit$Balance, pch = 16, col = mycol[cat])
legend("bottomright", title = "Income",legend = c("0 - 21", "21 - 33", "33 - 57","57 - 186"), pch = 16, col = mycol, bty = "n")
}
mycol <- c(rgb(255, 227,115, max = 255, alpha = 130, names = "blue50"),
rgb(235, 164, 73, max = 255, alpha = 100, names = "green50"),
rgb(255, 0, 0, max = 255, alpha = 100, names = "red"),
rgb(201, 33,0 , max = 255, alpha = 130, names = "yellow50"))
{
plot(tree.credit)
text(tree.credit, cex=0.8)
partition.tree(tree.credit, label = "", add = FALSE)
points(Credit$Rating,Credit$Balance, pch = 16, col = mycol[cat])
legend("bottomright", title = "Income",legend = c("0 - 21", "21 - 33", "33 - 57","57 - 186"), pch = 16, col = mycol, bty = "n")
}
mycol <- c(rgb(255, 227,115, max = 255, alpha = 130, names = "blue50"),
rgb(255, 126, 73, max = 255, alpha = 100, names = "green50"),
rgb(255, 0, 0, max = 255, alpha = 100, names = "red"),
rgb(201, 33,0 , max = 255, alpha = 130, names = "yellow50"))
{
plot(tree.credit)
text(tree.credit, cex=0.8)
partition.tree(tree.credit, label = "", add = FALSE)
points(Credit$Rating,Credit$Balance, pch = 16, col = mycol[cat])
legend("bottomright", title = "Income",legend = c("0 - 21", "21 - 33", "33 - 57","57 - 186"), pch = 16, col = mycol, bty = "n")
}
mycol <- c(rgb(255, 227,115, max = 255, alpha = 130, names = "blue50"),
rgb(255, 126, 73, max = 255, alpha = 130, names = "green50"),
rgb(255, 0, 0, max = 255, alpha = 100, names = "red"),
rgb(201, 33,0 , max = 255, alpha = 130, names = "yellow50"))
{
plot(tree.credit)
text(tree.credit, cex=0.8)
partition.tree(tree.credit, label = "", add = FALSE)
points(Credit$Rating,Credit$Balance, pch = 16, col = mycol[cat])
legend("bottomright", title = "Income",legend = c("0 - 21", "21 - 33", "33 - 57","57 - 186"), pch = 16, col = mycol, bty = "n")
}
mycol <- c(rgb(59, 122,87, max = 255, alpha = 130, names = "blue50"),
rgb(255, 227,115, max = 255, alpha = 130, names = "green50"),
rgb(255, 0, 0, max = 255, alpha = 100, names = "red"),
rgb(201, 33,0 , max = 255, alpha = 130, names = "yellow50"))
{
plot(tree.credit)
text(tree.credit, cex=0.8)
partition.tree(tree.credit, label = "", add = FALSE)
points(Credit$Rating,Credit$Balance, pch = 16, col = mycol[cat])
legend("bottomright", title = "Income",legend = c("0 - 21", "21 - 33", "33 - 57","57 - 186"), pch = 16, col = mycol, bty = "n")
}
mycol <- c(rgb(30, 179,0, max = 255, alpha = 130, names = "blue50"),
rgb(255, 227,115, max = 255, alpha = 130, names = "green50"),
rgb(255, 0, 0, max = 255, alpha = 100, names = "red"),
rgb(201, 33,0 , max = 255, alpha = 130, names = "yellow50"))
{
plot(tree.credit)
text(tree.credit, cex=0.8)
partition.tree(tree.credit, label = "", add = FALSE)
points(Credit$Rating,Credit$Balance, pch = 16, col = mycol[cat])
legend("bottomright", title = "Income",legend = c("0 - 21", "21 - 33", "33 - 57","57 - 186"), pch = 16, col = mycol, bty = "n")
}
mycol <- c(rgb(30, 179,0, max = 255, alpha = 130, names = "blue50"),
rgb(255, 227,115, max = 255, alpha = 130, names = "green50"),
rgb(255, 0, 0, max = 255, alpha = 100, names = "red"),
rgb(190, 33,0 , max = 255, alpha = 130, names = "yellow50"))
{
plot(tree.credit)
text(tree.credit, cex=0.8)
partition.tree(tree.credit, label = "", add = FALSE)
points(Credit$Rating,Credit$Balance, pch = 16, col = mycol[cat])
legend("bottomright", title = "Income",legend = c("0 - 21", "21 - 33", "33 - 57","57 - 186"), pch = 16, col = mycol, bty = "n")
}
mycol <- c(rgb(30, 179,0, max = 255, alpha = 130, names = "blue50"),
rgb(255, 227,115, max = 255, alpha = 130, names = "green50"),
rgb(255, 0, 0, max = 255, alpha = 100, names = "red"),
rgb(128, 33,0 , max = 255, alpha = 130, names = "yellow50"))
{
plot(tree.credit)
text(tree.credit, cex=0.8)
partition.tree(tree.credit, label = "", add = FALSE)
points(Credit$Rating,Credit$Balance, pch = 16, col = mycol[cat])
legend("bottomright", title = "Income",legend = c("0 - 21", "21 - 33", "33 - 57","57 - 186"), pch = 16, col = mycol, bty = "n")
}
mycol <- c(rgb(30, 179,0, max = 255, alpha = 130, names = "blue50"),
rgb(255, 227,115, max = 255, alpha = 130, names = "green50"),
rgb(255, 0, 0, max = 255, alpha = 100, names = "red"),
rgb(128, 0,20 , max = 255, alpha = 130, names = "yellow50"))
{
plot(tree.credit)
text(tree.credit, cex=0.8)
partition.tree(tree.credit, label = "", add = FALSE)
points(Credit$Rating,Credit$Balance, pch = 16, col = mycol[cat])
legend("bottomright", title = "Income",legend = c("0 - 21", "21 - 33", "33 - 57","57 - 186"), pch = 16, col = mycol, bty = "n")
}
mycol <- c(rgb(30, 179,0, max = 255, alpha = 130, names = "blue50"),
rgb(255, 227,115, max = 255, alpha = 130, names = "green50"),
rgb(255, 0, 0, max = 255, alpha = 100, names = "red"),
rgb(128, 0,20 , max = 255, alpha = 130, names = "yellow50"))
{
plot(tree.credit)
text(tree.credit, cex=0.8)
partition.tree(tree.credit, label = "", add = FALSE)
points(Credit$Rating,Credit$Balance, pch = 16, col = mycol[cat])
legend("bottomright", title = "Income",legend = c("0 - 21", "21 - 33", "33 - 57","57 - 186"), pch = 16, col = mycol, bty = "n")
}
mycol <- c(rgb(30, 179,0, max = 255, alpha = 130, names = "blue50"),
rgb(255, 227,115, max = 255, alpha = 130, names = "green50"),
rgb(255, 0, 0, max = 255, alpha = 100, names = "red"),
rgb(128, 0,40 , max = 255, alpha = 130, names = "yellow50"))
{
plot(tree.credit)
text(tree.credit, cex=0.8)
partition.tree(tree.credit, label = "", add = FALSE)
points(Credit$Rating,Credit$Balance, pch = 16, col = mycol[cat])
legend("bottomright", title = "Income",legend = c("0 - 21", "21 - 33", "33 - 57","57 - 186"), pch = 16, col = mycol, bty = "n")
}
partition.tree(tree.credit, label = "", add = FALSE, cex= 1.5)
points(Credit$Rating,Credit$Balance, pch = 16, col = mycol[cat])
{
plot(tree.credit)
text(tree.credit, cex=0.8)
partition.tree(tree.credit, label = "", add = FALSE, cex= 1.5)
points(Credit$Rating,Credit$Balance, pch = 16, col = mycol[cat])
legend("bottomright", title = "Income",legend = c("0 - 21", "21 - 33", "33 - 57","57 - 186"), pch = 16, col = mycol, bty = "n")
}
{
plot(tree.credit)
text(tree.credit, cex=0.8)
partition.tree(tree.credit, label = "", add = FALSE, cex= 1.2)
points(Credit$Rating,Credit$Balance, pch = 16, col = mycol[cat])
legend("bottomright", title = "Income",legend = c("0 - 21", "21 - 33", "33 - 57","57 - 186"), pch = 16, col = mycol, bty = "n")
}
mycol <- c(rgb(64, 128,0, max = 255, alpha = 130, names = "blue50"),
rgb(255, 227,115, max = 255, alpha = 130, names = "green50"),
rgb(255, 0, 0, max = 255, alpha = 100, names = "red"),
rgb(128, 0,40 , max = 255, alpha = 130, names = "yellow50"))
{
plot(tree.credit)
text(tree.credit, cex=0.8)
partition.tree(tree.credit, label = "", add = FALSE, cex= 1.2)
points(Credit$Rating,Credit$Balance, pch = 16, col = mycol[cat])
legend("bottomright", title = "Income",legend = c("0 - 21", "21 - 33", "33 - 57","57 - 186"), pch = 16, col = mycol, bty = "n")
}
mycol <- c(rgb(64, 128,0, max = 255, alpha = 130, names = "blue50"),
rgb(255, 227,115, max = 255, alpha = 130, names = "green50"),
rgb(255, 0, 0, max = 255, alpha = 100, names = "red"),
rgb(0, 85,225 , max = 255, alpha = 130, names = "yellow50"))
{
plot(tree.credit)
text(tree.credit, cex=0.8)
partition.tree(tree.credit, label = "", add = FALSE, cex= 1.2)
points(Credit$Rating,Credit$Balance, pch = 16, col = mycol[cat])
legend("bottomright", title = "Income",legend = c("0 - 21", "21 - 33", "33 - 57","57 - 186"), pch = 16, col = mycol, bty = "n")
}
plot(Credit$Rating,Credit$Balance, pch = 16, col = mycol[cat])
legend("bottomright", title = "Income",
legend = c("0 - 21", "21 - 33", "33 - 57","57 - 186"),
pch = 16, col = mycol, bty = "n")
plot(Credit$Rating,Credit$Balance, pch = 16, col = mycol[cat],
xlab = "Rating", ylab = "Balance")
legend("bottomright", title = "Income",
legend = c("0 - 21", "21 - 33", "33 - 57","57 - 186"),
pch = 16, col = mycol, bty = "n")
plot(tree.credit)
text(tree.credit, cex=0.8)
require(automap)
install.packages("automap")
?gridded
install.packages("gridded")
require(automap)
data(meuse)
coordinates(meuse) = ~x + y
coordinates(meuse)
data(meuse.grid)
gridded(meuse.grid) = ~x + y
autoKrige(zinc ~ soil + ffreq + dist, meuse, meuse.grid)
# Load Libraries ---------
{
library(tidyverse)
library(ranger)
library(caret)
library(mgcv)
library(gbm)
library(reshape2)
library(dplyr)
library(tidyverse)
library(randomForest)
library(skimr)
}
rm(list = ls())
setwd("/Users/chloestipinovich/Documents/2020/Thesis Project/grass-pollen")
# Read in data ----------
data      = read.csv("Final_Data/data_complete.csv")
data      = as.data.frame(data)
names(data)
head(data)
data      = dplyr::select(data, -File.Name, -Dataset, -aid, -Variance)
data      = rename(data,  VI_count = Count, VI_minimum = Minimum, VI_maximum = Maximum,
VI_range = Range, VI_mean = Mean, VI_sd = Standard.Deviation,
VI_UQ = Upper.Quartile,VI_U1.5.IQR = Upper.1.5.IQR, VI_L1.5.IQR = Lower.1.5.IQR,
VI_LQ = Lower.Quartile)
names(data)
data %>%
group_by(fyear) %>%
summarise(no_rows = length(fyear))
data$date = as.Date(data$date )
ggpubr::ggarrange(pollen, vi_max, ncol = 1)
train      = data[which(data$fyear=="2011"|data$fyear=="2012"|data$fyear=="2013"),]
validation = data[which(data$fyear=="2014"),]
nrow(validation)
skim(validation)
test       = data[which(data$fyear=="2018"),]
models_RMSE               = matrix(NA, nrow = 5, ncol = 3)
models_accuracy           = matrix(NA, ncol = 4, nrow = 5)
colnames(models_RMSE)     = c("Total", "In Season", "Out of Season")
colnames(models_accuracy) = c("Accuracy for Reg to cats", "Accuracy straight to cats", "In Season","Out of Season")
# pdf("1 Year Counts.pdf", width=10, height=7)
plot(validation$pollen_count, type = 'l', xlab = "Days Since 1 January",
ylab = "Pollen Count")
# Regression Models -----------
# Model 1; no veg index, no lags. Just weather data, ds and in/out seasin
# 1.1 Reg Model ----------
{
M1_Reg_Data = dplyr::select(train, -logvalue, -date, - pollen_cat, -X,
-veg_index, - VI_count, - VI_minimum, - VI_maximum,
- VI_range, -VI_mean, - VI_sd, - VI_UQ,
-VI_U1.5.IQR, -veg_index, -VI_L1.5.IQR, -VI_LQ, -visibility) #%>%
rf_grid    = expand.grid(mtry = 10:15,
splitrule = 'variance',
min.node.size = 5) #Default for regression is 5. Controls tree size.
ctrl       = trainControl(method = 'oob', verboseIter = T)
M1_Reg     = train(pollen_count ~ .,
data = M1_Reg_Data,
method = 'ranger',
num.trees = 2000,
verbose = T,
importance = 'impurity',
trControl = ctrl,
set.seed(2020),
tuneGrid = rf_grid) #Here is the grid
}
plot(varImp(M1_Reg))
yhat           = predict(M1_Reg, validation)
y              = validation$pollen_count
(models_RMSE[1,1] = mean((y - yhat)^2))
res <- residuals(naive(yhat))
install.packages("modeest")
# 10.81856
library(modeest)
res <- residuals(naive(yhat))
library(httr)
library(readr)
library(jsonlite)
r <- GET("https://modis.ornl.gov/rst/api/v1/MOD13Q1V006/dates?latitude=-33.9345&longitude=18.4771")
dates <- content(r)$dates
r <- GET("https://modis.ornl.gov/rst/api/v1/MOD13Q1/dates?latitude=-33.9345&longitude=18.4771")
dates <- content(r)$dates
modis_dates <- lapply(dates, function(dt) dt$modis_date)
calendar_dates <- lapply(dates, function(dt) dt$calendar_date)
# Print the first ten MODIS dates
dates[1:10]
modis_dates
daysVI <- lapply(dates, function(dt) dt$_250m_16_days_EVI)
?v
?MODISSubsets
install.packages("MODISSubsets")
library(MODISSubsets)
install.packages("MODISSubsets")
install.packages("MODISSubsets")
install.packages("MODIStools")
install.packages("MODISTools")
library(MODISTools)
MODISSubsets(LoadDat = PREDICTS,
Products = "MOD13Q1",
Bands = c("250m_16_days_EVI",
"250m_16_days_VI_Quality"),
Size = c(3,3),StartDate = FALSE, TimeSeriesLength = 1)
library(MODISTools)
library(MODISTools)
MODISSubsets(LoadDat = PREDICTS,
Products = "MOD13Q1",
Bands = c("250m_16_days_EVI",
"250m_16_days_VI_Quality"),
Size = c(3,3),StartDate = FALSE, TimeSeriesLength = 1)
MODISTools::MODISSubsets(LoadDat = PREDICTS,
Products = "MOD13Q1",
Bands = c("250m_16_days_EVI",
"250m_16_days_VI_Quality"),
Size = c(3,3),StartDate = FALSE, TimeSeriesLength = 1)
library(MODISTools)
=======
splitrule = 'variance',
min.node.size = 5) #Default for regression is 5. Controls tree size.
ctrl <- trainControl(method = 'oob', verboseIter = T)
rf_gridsearch <- train(value ~ .,
data = train,
method = 'ranger',
num.trees = 2000,
verbose = T,
importance = 'impurity',
trControl = ctrl,
tuneGrid = rf_grid) #Here is the grid
}
plot(varImp(rf_gridsearch))
(varImportance = varImp(rf_gridsearch))
par(mfrow = c(1, 1))
yhat          = predict(rf_gridsearch, test)
y             = test$value
(models_RMSE[4,1] = mean((y - yhat)^2))
cor(y, yhat)^2
plot(yhat ~ y)
abline(0, 1, col = 'red')
cor(y, yhat)
plot(y, type = 'l')
lines(yhat, col = 'red', type = 'l')
yIn     = (test %>% filter(season == "In"))$value
yOut    = (test %>% filter(season == "Out"))$value
yhatIn  = yhat[which(test$season == "In")]
yhatOut = yhat[which(test$season == "Out")]
(models_RMSE[4,2] = mean((yIn - yhatIn)^2))   # 68.3992
cor(yIn, yhatIn)^2       # 0.4778134
plot(yIn ~ yhatIn)
abline(0, 1, col = 'red')
(models_RMSE[4,3] = mean((yOut - yhatOut)^2)) # 11.13848
cor(yOut, yhatOut)^2     # 0.03024854
plot(yOut ~ yhatOut)
abline(0, 1, col = 'red')
models_RMSE
(varImportance = varImp(rf_gridsearch))
varImportance
nrow(varImportance)
varImportance = data.frame(varImportance[1])
varImportance
varImportance = data.frame(varImportance[1])
varImp_names  = rownames(varImportance)
varImp_names
order()
varImportance = data.frame(order(varImportance[1]))
varImp_names  = rownames(varImportance)
varImp_names
varImportance
varImp_names  = rownames(order(varImportance))
varImportance = data.frame(varImportance[1])
varImp_names  = rownames(order(varImportance))
varImp_names
varImportance = data.frame(varImportance[1])
varImp_names  = rownames(varImportance)
varImp_names
varImportance = data.frame(varImportance[1])
(varImportance = varImp(rf_gridsearch))
varImportance = data.frame(varImportance[1])
varImp_names  = order(rownames(varImportance))
varImp_names
(varImportance = varImp(rf_gridsearch))
plot(varImp(rf_gridsearch))
models_RMSE
rf_data <- dplyr::select(merged, -logvalue, -date, -Range) %>%
mutate(count_lag1 = lag(value, 1),
count_lag2 = lag(value, 1),
count_lag3 = lag(value, 1),
count_lag4 = lag(value, 1),
count_lag5 = lag(value, 1),
maxtemp.anom_lag1 = lag(maxtemp.anom, 1),
maxtemp.anom_lag2 = lag(maxtemp.anom, 2),
maxtemp.anom_lag3 = lag(maxtemp.anom, 3),
maxtemp.anom_lag4 = lag(maxtemp.anom, 4),
Visibility_lag1   = lag(Visibility, 1),
Visibility_lag2   = lag(Visibility, 2),
Visibility_lag3   = lag(Visibility, 3),
Visibility_lag4   = lag(Visibility, 4),
value.wind_speed_lag1    = lag(value.wind_speed, 1),
value.wind_speed_lag2    = lag(value.wind_speed, 2),
value.wind_speed_lag3    = lag(value.wind_speed, 3),
value.humid_lag1         = lag(value.humid, 1),
value.humid_lag2         = lag(value.humid, 2),
value.humid_lag3         = lag(value.humid, 3),
VI_mean_lag1 = lag(Mean, 16),
VI_mean_lag2 = lag(Mean, 32),
VI_mean_lag3 = lag(Mean, 48),
VI_max_lag1 = lag(Maximum, 16),
VI_max_lag2 = lag(Maximum, 32),
VI_max_lag3 = lag(Maximum, 48),
VI_count_lag1 = lag(Count, 16),
VI_count_lag2 = lag(Count, 32),
VI_count_lag3 = lag(Count, 48),
VI_up15_lag1 = lag(Upper.1.5.IQR, 16),
VI_up15_lag2 = lag(Upper.1.5.IQR, 32),
VI_up15_lag3 = lag(Upper.1.5.IQR, 48)) %>%
mutate(wind_dir_bin = case_when(
value.wind_dir > 100 & value.wind_dir < 200 ~ "dir1",
value.wind_dir <= 100 | value.wind_dir >= 200 ~ "dir2"
)) %>% mutate(count_cat_in = case_when(
value < 1 ~ "Very low",
value > 1 & value <= 4 ~ "Low",
value > 4 & value <= 8 ~ "Moderate",
value > 8 & value <= 14.8 ~ "High",
value > 14.8 ~ "Very high")
) %>% dplyr::select(-count_cat_in) %>% na.omit()
train <- filter(rf_data, fyear != 2011)
test <- filter(rf_data, fyear == 2011)
train <- filter(rf_data, fyear != testYear)
test <- filter(rf_data, fyear == testYear)
summary(rf_data$fyear)
rf_grid <- expand.grid(mtry = 10:20,
splitrule = 'variance',
min.node.size = 5) #Default for regression is 5. Controls tree size.
ctrl <- trainControl(method = 'oob', verboseIter = T)
rf_gridsearch <- train(value ~ .,
data = train,
method = 'ranger',
num.trees = 2000,
verbose = T,
importance = 'impurity',
trControl = ctrl,
tuneGrid = rf_grid) #Here is the grid
plot(varImp(rf_gridsearch))
(varImportance = varImp(rf_gridsearch))
plot(varImp(rf_gridsearch))
(varImportance = varImp(rf_gridsearch))
par(mfrow = c(1, 1))
yhat          = predict(rf_gridsearch, test)
y             = test$value
(models_RMSE[5,1] = mean((y - yhat)^2))
cor(y, yhat)^2
plot(yhat ~ y)
abline(0, 1, col = 'red')
cor(y, yhat)
plot(y, type = 'l')
lines(yhat, col = 'red', type = 'l')
yIn     = (test %>% filter(season == "In"))$value
yOut    = (test %>% filter(season == "Out"))$value
yhatIn  = yhat[which(test$season == "In")]
yhatOut = yhat[which(test$season == "Out")]
(models_RMSE[5,2] = mean((yIn - yhatIn)^2))   # 68.3992
cor(yIn, yhatIn)^2       # 0.4778134
plot(yIn ~ yhatIn)
abline(0, 1, col = 'red')
(models_RMSE[5,3] = mean((yOut - yhatOut)^2)) # 11.13848
cor(yOut, yhatOut)^2     # 0.03024854
plot(yOut ~ yhatOut)
abline(0, 1, col = 'red')
models_RMSE
testYear = 2012
# 1. Model ----------
{
# Create lag values
rf_data = dplyr::select(grassdata, -logvalue, -date) %>%
mutate(count_cat_in = case_when(
value < 1 ~ "Very low",
value > 1 & value <= 4 ~ "Low",
value > 4 & value <= 8 ~ "Moderate",
value > 8 & value <= 14.8 ~ "High",
value > 14.8 ~ "Very high")) %>% mutate(season = case_when(
ds > 240 | ds < 30 ~ "In",
ds >= 30 | ds <= 240 ~ "Out"
)) %>% dplyr::select(-count_cat_in) %>% na.omit()
train = filter(rf_data, fyear != testYear)
test  = filter(rf_data, fyear == testYear)
summary(rf_data$fyear)
rf_grid = expand.grid(mtry = 10:20,
splitrule = 'variance',
min.node.size = 5) #Default for regression is 5. Controls tree size.
ctrl    = trainControl(method = 'oob', verboseIter = T)
rf_gridsearch = train(value ~ .,
data = train,
method = 'ranger',
num.trees = 2000,
verbose = T,
importance = 'impurity',
trControl = ctrl,
tuneGrid = rf_grid) #Here is the grid
}
plot(varImp(rf_gridsearch))
(varImportance = varImp(rf_gridsearch))
par(mfrow = c(1, 1))
yhat           = predict(rf_gridsearch, test)
y              = test$value
(models_RMSE[1,1] = mean((y - yhat)^2))
# 35.6903
plot(yhat ~ y)
abline(0, 1, col = 'red')
cor(y, yhat)^2
# 0.574835
plot(y, type = 'l')
lines(yhat, col = 'red', type = 'l')
# How well does it perform in and out of season?
yIn     = (test %>% filter(season == "In"))$value
yOut    = (test %>% filter(season == "Out"))$value
yhatIn  = yhat[which(test$season == "In")]
yhatOut = yhat[which(test$season == "Out")]
(models_RMSE[1,2] = mean((yIn - yhatIn)^2))   # 68.3992
cor(yIn, yhatIn)^2       # 0.4778134
plot(yIn ~ yhatIn)
abline(0, 1, col = 'red')
(models_RMSE[1,3] = mean((yOut - yhatOut)^2)) # 11.13848
cor(yOut, yhatOut)^2     # 0.03024854
plot(yOut ~ yhatOut)
abline(0, 1, col = 'red')
# 2. Model ----------
{
# Create lag values
rf_data <- dplyr::select(merged, -logvalue, -date, -Range) %>%
mutate(count_cat_in = case_when(
value < 1 ~ "Very low",
value > 1 & value <= 4 ~ "Low",
value > 4 & value <= 8 ~ "Moderate",
value > 8 & value <= 14.8 ~ "High",
value > 14.8 ~ "Very high")
) %>% dplyr::select(-count_cat_in) %>% na.omit()
train <- filter(rf_data, fyear != testYear)
test <- filter(rf_data, fyear == testYear)
summary(rf_data$fyear)
rf_grid <- expand.grid(mtry = 10:20,
splitrule = 'variance',
min.node.size = 5) #Default for regression is 5. Controls tree size.
ctrl <- trainControl(method = 'oob', verboseIter = T)
rf_gridsearch <- train(value ~ .,
data = train,
method = 'ranger',
num.trees = 2000,
verbose = T,
importance = 'impurity',
trControl = ctrl,
tuneGrid = rf_grid) #Here is the grid
}
plot(varImp(rf_gridsearch))
(varImportance = varImp(rf_gridsearch))
par(mfrow = c(1, 1))
yhat          = predict(rf_gridsearch, test)
y             = test$value
(models_RMSE[2,1] = mean((y - yhat)^2))
# 65.04818
cor(y, yhat)^2
plot(yhat ~ y)
abline(0, 1, col = 'red')
cor(y, yhat)
plot(y, type = 'l')
lines(yhat, col = 'red', type = 'l')
# How well does it perform in and out of season?
yIn     = (test %>% filter(season == "In"))$value
yOut    = (test %>% filter(season == "Out"))$value
yhatIn  = yhat[which(test$season == "In")]
yhatOut = yhat[which(test$season == "Out")]
(models_RMSE[2,2] = mean((yIn - yhatIn)^2))   # 126.2724
cor(yIn, yhatIn)^2
plot(yIn ~ yhatIn)
abline(0, 1, col = 'red')
(models_RMSE[2,3] = mean((yOut - yhatOut)^2)) # 2.811988
cor(yOut, yhatOut)^2
plot(yOut ~ yhatOut)
abline(0, 1, col = 'red')
# 3. Model -----------
# Create lag values
{
rf_data <- dplyr::select(merged, -logvalue, -date, -Range) %>%
mutate(count_lag1 = lag(value, 1),
count_lag2 = lag(value, 1),
count_lag3 = lag(value, 1),
count_lag4 = lag(value, 1),
count_lag5 = lag(value, 1)) %>%
mutate(count_cat_in = case_when(
value < 1 ~ "Very low",
value > 1 & value <= 4 ~ "Low",
value > 4 & value <= 8 ~ "Moderate",
value > 8 & value <= 14.8 ~ "High",
value > 14.8 ~ "Very high")
) %>% dplyr::select(-count_cat_in) %>% na.omit()
train <- filter(rf_data, fyear != testYear)
test <- filter(rf_data, fyear == testYear)
summary(rf_data$fyear)
rf_grid <- expand.grid(mtry = 10:20,
splitrule = 'variance',
min.node.size = 5) #Default for regression is 5. Controls tree size.
ctrl <- trainControl(method = 'oob', verboseIter = T)
rf_gridsearch <- train(value ~ .,
data = train,
method = 'ranger',
num.trees = 2000,
verbose = T,
importance = 'impurity',
trControl = ctrl,
tuneGrid = rf_grid) #Here is the grid
}
plot(varImp(rf_gridsearch))
(varImportance = varImp(rf_gridsearch))
par(mfrow = c(1, 1))
yhat          = predict(rf_gridsearch, test)
y             = test$value
(models_RMSE[3,1] = mean((y - yhat)^2))
cor(y, yhat)^2
plot(yhat ~ y)
abline(0, 1, col = 'red')
cor(y, yhat)
plot(y, type = 'l')
lines(yhat, col = 'red', type = 'l')
# How well does it perform in and out of season?
yIn     = (test %>% filter(season == "In"))$value
yOut    = (test %>% filter(season == "Out"))$value
yhatIn  = yhat[which(test$season == "In")]
yhatOut = yhat[which(test$season == "Out")]
(models_RMSE[3,2] = mean((yIn - yhatIn)^2))   # 68.3992
cor(yIn, yhatIn)^2       # 0.4778134
plot(yIn ~ yhatIn)
abline(0, 1, col = 'red')
(models_RMSE[3,3] = mean((yOut - yhatOut)^2)) # 11.13848
cor(yOut, yhatOut)^2     # 0.03024854
plot(yOut ~ yhatOut)
abline(0, 1, col = 'red')
# 4. Model -----------
# Create lag values
{
rf_data <- dplyr::select(merged, -logvalue, -date, -Range) %>%
mutate(count_lag1 = lag(value, 1),
count_lag2 = lag(value, 1),
count_lag3 = lag(value, 1),
count_lag4 = lag(value, 1),
count_lag5 = lag(value, 1),
maxtemp.anom_lag1 = lag(maxtemp.anom, 1),
maxtemp.anom_lag2 = lag(maxtemp.anom, 2),
maxtemp.anom_lag3 = lag(maxtemp.anom, 3),
maxtemp.anom_lag4 = lag(maxtemp.anom, 4),
Visibility_lag1   = lag(Visibility, 1),
Visibility_lag2   = lag(Visibility, 2),
Visibility_lag3   = lag(Visibility, 3),
Visibility_lag4   = lag(Visibility, 4),
value.wind_speed_lag1    = lag(value.wind_speed, 1),
value.wind_speed_lag2    = lag(value.wind_speed, 2),
value.wind_speed_lag3    = lag(value.wind_speed, 3),
value.humid_lag1         = lag(value.humid, 1),
value.humid_lag2         = lag(value.humid, 2),
value.humid_lag3         = lag(value.humid, 3)) %>%
mutate(wind_dir_bin = case_when(
value.wind_dir > 100 & value.wind_dir < 200 ~ "dir1",
value.wind_dir <= 100 | value.wind_dir >= 200 ~ "dir2"
)) %>% mutate(count_cat_in = case_when(
value < 1 ~ "Very low",
value > 1 & value <= 4 ~ "Low",
value > 4 & value <= 8 ~ "Moderate",
value > 8 & value <= 14.8 ~ "High",
value > 14.8 ~ "Very high")
) %>% dplyr::select(-count_cat_in) %>% na.omit()
train <- filter(rf_data, fyear != testYear)
test <- filter(rf_data, fyear == testYear)
summary(rf_data$fyear)
rf_grid <- expand.grid(mtry = 10:20,
splitrule = 'variance',
min.node.size = 5) #Default for regression is 5. Controls tree size.
ctrl <- trainControl(method = 'oob', verboseIter = T)
rf_gridsearch <- train(value ~ .,
data = train,
method = 'ranger',
num.trees = 2000,
verbose = T,
importance = 'impurity',
trControl = ctrl,
tuneGrid = rf_grid) #Here is the grid
}
plot(varImp(rf_gridsearch))
(varImportance = varImp(rf_gridsearch))
par(mfrow = c(1, 1))
yhat          = predict(rf_gridsearch, test)
y             = test$value
(models_RMSE[4,1] = mean((y - yhat)^2))
cor(y, yhat)^2
plot(yhat ~ y)
abline(0, 1, col = 'red')
cor(y, yhat)
plot(y, type = 'l')
lines(yhat, col = 'red', type = 'l')
# How well does it perform in and out of season?
yIn     = (test %>% filter(season == "In"))$value
yOut    = (test %>% filter(season == "Out"))$value
yhatIn  = yhat[which(test$season == "In")]
yhatOut = yhat[which(test$season == "Out")]
(models_RMSE[4,2] = mean((yIn - yhatIn)^2))   # 68.3992
cor(yIn, yhatIn)^2       # 0.4778134
plot(yIn ~ yhatIn)
abline(0, 1, col = 'red')
(models_RMSE[4,3] = mean((yOut - yhatOut)^2)) # 11.13848
cor(yOut, yhatOut)^2     # 0.03024854
plot(yOut ~ yhatOut)
abline(0, 1, col = 'red')
# 5. Model -----------
# Create lag values
{
rf_data <- dplyr::select(merged, -logvalue, -date, -Range) %>%
mutate(count_lag1 = lag(value, 1),
count_lag2 = lag(value, 1),
count_lag3 = lag(value, 1),
count_lag4 = lag(value, 1),
count_lag5 = lag(value, 1),
maxtemp.anom_lag1 = lag(maxtemp.anom, 1),
maxtemp.anom_lag2 = lag(maxtemp.anom, 2),
maxtemp.anom_lag3 = lag(maxtemp.anom, 3),
maxtemp.anom_lag4 = lag(maxtemp.anom, 4),
Visibility_lag1   = lag(Visibility, 1),
Visibility_lag2   = lag(Visibility, 2),
Visibility_lag3   = lag(Visibility, 3),
Visibility_lag4   = lag(Visibility, 4),
value.wind_speed_lag1    = lag(value.wind_speed, 1),
value.wind_speed_lag2    = lag(value.wind_speed, 2),
value.wind_speed_lag3    = lag(value.wind_speed, 3),
value.humid_lag1         = lag(value.humid, 1),
value.humid_lag2         = lag(value.humid, 2),
value.humid_lag3         = lag(value.humid, 3),
VI_mean_lag1 = lag(Mean, 16),
VI_mean_lag2 = lag(Mean, 32),
VI_mean_lag3 = lag(Mean, 48),
VI_max_lag1 = lag(Maximum, 16),
VI_max_lag2 = lag(Maximum, 32),
VI_max_lag3 = lag(Maximum, 48),
VI_count_lag1 = lag(Count, 16),
VI_count_lag2 = lag(Count, 32),
VI_count_lag3 = lag(Count, 48),
VI_up15_lag1 = lag(Upper.1.5.IQR, 16),
VI_up15_lag2 = lag(Upper.1.5.IQR, 32),
VI_up15_lag3 = lag(Upper.1.5.IQR, 48)) %>%
mutate(wind_dir_bin = case_when(
value.wind_dir > 100 & value.wind_dir < 200 ~ "dir1",
value.wind_dir <= 100 | value.wind_dir >= 200 ~ "dir2"
)) %>% mutate(count_cat_in = case_when(
value < 1 ~ "Very low",
value > 1 & value <= 4 ~ "Low",
value > 4 & value <= 8 ~ "Moderate",
value > 8 & value <= 14.8 ~ "High",
value > 14.8 ~ "Very high")
) %>% dplyr::select(-count_cat_in) %>% na.omit()
train <- filter(rf_data, fyear != testYear)
test <- filter(rf_data, fyear == testYear)
summary(rf_data$fyear)
rf_grid <- expand.grid(mtry = 10:20,
splitrule = 'variance',
min.node.size = 5) #Default for regression is 5. Controls tree size.
ctrl <- trainControl(method = 'oob', verboseIter = T)
rf_gridsearch <- train(value ~ .,
data = train,
method = 'ranger',
num.trees = 2000,
verbose = T,
importance = 'impurity',
trControl = ctrl,
tuneGrid = rf_grid) #Here is the grid
}
plot(varImp(rf_gridsearch))
(varImportance = varImp(rf_gridsearch))
par(mfrow = c(1, 1))
yhat          = predict(rf_gridsearch, test)
y             = test$value
(models_RMSE[5,1] = mean((y - yhat)^2))
cor(y, yhat)^2
plot(yhat ~ y)
abline(0, 1, col = 'red')
cor(y, yhat)
plot(y, type = 'l')
lines(yhat, col = 'red', type = 'l')
# How well does it perform in and out of season?
yIn     = (test %>% filter(season == "In"))$value
yOut    = (test %>% filter(season == "Out"))$value
yhatIn  = yhat[which(test$season == "In")]
yhatOut = yhat[which(test$season == "Out")]
(models_RMSE[5,2] = mean((yIn - yhatIn)^2))   # 68.3992
cor(yIn, yhatIn)^2       # 0.4778134
plot(yIn ~ yhatIn)
abline(0, 1, col = 'red')
(models_RMSE[5,3] = mean((yOut - yhatOut)^2)) # 11.13848
cor(yOut, yhatOut)^2     # 0.03024854
plot(yOut ~ yhatOut)
abline(0, 1, col = 'red')
# Reduce number of variables --------
varImportance = data.frame(varImportance[1])
varImp_names  = order(rownames(varImportance))
# GBM -------------
ctrl <- trainControl(method = 'cv', number = 10, verboseIter = T)
gbm_grid <- expand.grid(n.trees = c(300, 500, 1000), # Try these numbers of trees
interaction.depth = c(1, 2, 6), # Try these interaction depths
shrinkage = c(0.01, 0.005, 0.001), #
n.minobsinnode = 1) # Set min node size to 1
gbm_gridsearch <- train(value ~ ., data = train,
method = 'gbm',
distribution = 'gaussian', # Because its a regression problem
trControl = ctrl,
verbose = F, # Keeps me updated on the progress
tuneGrid = gbm_grid)
yhat_gbm <- predict(gbm_gridsearch, test)
data.frame(`GBM` = yhat_gbm, 'Random Forest' = yhat, Actual = y) %>%
mutate(x = 1:nrow(.)) %>%
melt(id.vars = 'x') %>%
rename('Pollen Count' = value, 'Model' = variable) %>%
ggplot(aes(x, `Pollen Count`, colour = Model)) +
geom_line() +
facet_wrap(.~Model, nrow = 3) +
xlab("Day Number") +
theme_minimal()
plot(yhat_gbm ~ y)
cor(yhat_gbm, y)^2
abline(0, 1)
yhat_gbm2 = c(yhat_gbm[1:280], c(0))
cor(yhat_gbm2, y)^2
plot(yhat_gbm2, type = 'l')
lines(y, col = 'red')
models_RMSE
# Save wworkspace ------------
save.image('RF_draft_workspace.RData')
>>>>>>> Stashed changes
