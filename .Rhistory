points(Credit$Rating,Credit$Balance, pch = 16, col = cat)
text(tree.credit, cex=0.8)
partition.tree(tree.credit, label = "", add = FALSE)
mycol <- c(rgb(0, 0, 250, max = 255, alpha = 50, names = "blue50"),
rgb(0, 250, 0, max = 255, alpha = 50, names = "green50"),
rgb(250, 0, 0, max = 255, alpha = 50, names = "red"),
rgb(255, 255,0 , max = 255, alpha = 50, names = "yellow50"))
points(Credit$Rating,Credit$Balance, pch = 16, col = cat)
legend("bottomright", legend = "Income", pch = 16, col = mycol, bty = "n")
mycol <- c(rgb(0, 0, 250, max = 255, alpha = 50, names = "blue50"),
rgb(0, 250, 0, max = 255, alpha = 50, names = "green50"),
rgb(250, 0, 0, max = 255, alpha = 50, names = "red"),
rgb(255, 255,0 , max = 255, alpha = 50, names = "yellow50"))
points(Credit$Rating,Credit$Balance, pch = 16, col = mycol)
legend("bottomright", legend = "Income", pch = 16, col = mycol, bty = "n")
text(tree.credit, cex=0.8)
partition.tree(tree.credit, label = "", add = FALSE)
mycol <- c(rgb(0, 0, 250, max = 255, alpha = 50, names = "blue50"),
rgb(0, 250, 0, max = 255, alpha = 50, names = "green50"),
rgb(250, 0, 0, max = 255, alpha = 50, names = "red"),
rgb(255, 255,0 , max = 255, alpha = 50, names = "yellow50"))
points(Credit$Rating,Credit$Balance, pch = 16, col = mycol)
legend("bottomright", legend = "Income", pch = 16, col = mycol, bty = "n")
points(Credit$Rating,Credit$Balance, pch = 16, col = mycol[cat])
partition.tree(tree.credit, label = "", add = FALSE)
mycol <- c(rgb(0, 0, 250, max = 255, alpha = 50, names = "blue50"),
rgb(0, 250, 0, max = 255, alpha = 50, names = "green50"),
rgb(250, 0, 0, max = 255, alpha = 50, names = "red"),
rgb(255, 255,0 , max = 255, alpha = 50, names = "yellow50"))
points(Credit$Rating,Credit$Balance, pch = 16, col = mycol[cat])
legend("bottomright", legend = "Income", pch = 16, col = mycol, bty = "n")
mycol <- c(rgb(0, 0, 250, max = 255, alpha = 50, names = "blue50"),
rgb(0, 250, 0, max = 255, alpha = 50, names = "green50"),
rgb(250, 0, 0, max = 255, alpha = 50, names = "red"),
rgb(255, 193,69 , max = 255, alpha = 50, names = "yellow50"))
text(tree.credit, cex=0.8)
partition.tree(tree.credit, label = "", add = FALSE)
mycol <- c(rgb(0, 0, 250, max = 255, alpha = 50, names = "blue50"),
rgb(0, 250, 0, max = 255, alpha = 50, names = "green50"),
rgb(250, 0, 0, max = 255, alpha = 50, names = "red"),
rgb(255, 193,69 , max = 255, alpha = 50, names = "yellow50"))
points(Credit$Rating,Credit$Balance, pch = 16, col = mycol[cat])
legend("bottomright", legend = "Income", pch = 16, col = mycol, bty = "n")
mycol <- c(rgb(0, 0, 250, max = 255, alpha = 50, names = "blue50"),
rgb(0, 250, 0, max = 255, alpha = 50, names = "green50"),
rgb(250, 0, 0, max = 255, alpha = 50, names = "red"),
rgb(255, 193,69 , max = 255, alpha = 100, names = "yellow50"))
points(Credit$Rating,Credit$Balance, pch = 16, col = mycol[cat])
mycol <- c(rgb(0, 0, 250, max = 255, alpha = 50, names = "blue50"),
rgb(100, 181, 83, max = 255, alpha = 50, names = "green50"),
rgb(250, 0, 0, max = 255, alpha = 50, names = "red"),
rgb(255, 193,69 , max = 255, alpha = 100, names = "yellow50"))
points(Credit$Rating,Credit$Balance, pch = 16, col = mycol[cat])
legend("bottomright", legend = "Income", pch = 16, col = mycol, bty = "n")
text(tree.credit, cex=0.8)
partition.tree(tree.credit, label = "", add = FALSE)
mycol <- c(rgb(0, 0, 250, max = 255, alpha = 50, names = "blue50"),
rgb(100, 181, 83, max = 255, alpha = 50, names = "green50"),
rgb(250, 0, 0, max = 255, alpha = 50, names = "red"),
rgb(255, 193,69 , max = 255, alpha = 100, names = "yellow50"))
points(Credit$Rating,Credit$Balance, pch = 16, col = mycol[cat])
legend("bottomright", legend = "Income", pch = 16, col = mycol, bty = "n")
partition.tree(tree.credit, label = "", add = FALSE)
mycol <- c(rgb(0, 0, 250, max = 255, alpha = 100, names = "blue50"),
rgb(100, 181, 83, max = 255, alpha = 100, names = "green50"),
rgb(250, 0, 0, max = 255, alpha = 100, names = "red"),
rgb(255, 193,69 , max = 255, alpha = 100, names = "yellow50"))
points(Credit$Rating,Credit$Balance, pch = 16, col = mycol[cat])
legend("bottomright", legend = "Income", pch = 16, col = mycol, bty = "n")
summary(Credit$Income)
legend("bottomright", legend = c("0 - 21", "21 - 33", "33 - 57","57 - 186"), pch = 16, col = mycol[cat], bty = "n")
partition.tree(tree.credit, label = "", add = FALSE)
mycol <- c(rgb(0, 0, 250, max = 255, alpha = 100, names = "blue50"),
rgb(100, 181, 83, max = 255, alpha = 100, names = "green50"),
rgb(250, 0, 0, max = 255, alpha = 100, names = "red"),
rgb(255, 193,69 , max = 255, alpha = 100, names = "yellow50"))
points(Credit$Rating,Credit$Balance, pch = 16, col = mycol[cat])
legend("bottomright", legend = c("0 - 21", "21 - 33", "33 - 57","57 - 186"), pch = 16, col = mycol, bty = "n")
?legend
legend("bottomright", title = "Income",legend = c("0 - 21", "21 - 33", "33 - 57","57 - 186"), pch = 16, col = mycol, bty = "n")
mycol <- c(rgb(255, 193,69, max = 255, alpha = 100, names = "blue50"),
rgb(245, 143, 42, max = 255, alpha = 100, names = "green50"),
rgb(250, 0, 0, max = 255, alpha = 100, names = "red"),
rgb(255, 193,69 , max = 255, alpha = 100, names = "yellow50"))
points(Credit$Rating,Credit$Balance, pch = 16, col = mycol[cat])
partition.tree(tree.credit, label = "", add = FALSE)
mycol <- c(rgb(255, 193,69, max = 255, alpha = 100, names = "blue50"),
rgb(245, 143, 42, max = 255, alpha = 100, names = "green50"),
rgb(250, 0, 0, max = 255, alpha = 100, names = "red"),
rgb(255, 193,69 , max = 255, alpha = 100, names = "yellow50"))
points(Credit$Rating,Credit$Balance, pch = 16, col = mycol[cat])
legend("bottomright", title = "Income",legend = c("0 - 21", "21 - 33", "33 - 57","57 - 186"), pch = 16, col = mycol, bty = "n")
mycol <- c(rgb(255, 193,69, max = 255, alpha = 100, names = "blue50"),
rgb(255, 102, 25, max = 255, alpha = 100, names = "green50"),
rgb(250, 0, 0, max = 255, alpha = 100, names = "red"),
rgb(255, 193,69 , max = 255, alpha = 100, names = "yellow50"))
{
plot(tree.credit)
text(tree.credit, cex=0.8)
partition.tree(tree.credit, label = "", add = FALSE)
points(Credit$Rating,Credit$Balance, pch = 16, col = mycol[cat])
legend("bottomright", title = "Income",legend = c("0 - 21", "21 - 33", "33 - 57","57 - 186"), pch = 16, col = mycol, bty = "n")
}
mycol <- c(rgb(255, 193,69, max = 255, alpha = 100, names = "blue50"),
rgb(255, 102, 25, max = 255, alpha = 100, names = "green50"),
rgb(255, 0, 0, max = 255, alpha = 100, names = "red"),
rgb(102, 0,0 , max = 255, alpha = 100, names = "yellow50"))
{
plot(tree.credit)
text(tree.credit, cex=0.8)
partition.tree(tree.credit, label = "", add = FALSE)
points(Credit$Rating,Credit$Balance, pch = 16, col = mycol[cat])
legend("bottomright", title = "Income",legend = c("0 - 21", "21 - 33", "33 - 57","57 - 186"), pch = 16, col = mycol, bty = "n")
}
mycol <- c(rgb(255, 193,69, max = 255, alpha = 100, names = "blue50"),
rgb(255, 102, 25, max = 255, alpha = 100, names = "green50"),
rgb(255, 0, 0, max = 255, alpha = 100, names = "red"),
rgb(153, 5,0 , max = 255, alpha = 100, names = "yellow50"))
mycol <- c(rgb(255, 193,69, max = 255, alpha = 100, names = "blue50"),
rgb(255, 102, 25, max = 255, alpha = 100, names = "green50"),
rgb(255, 0, 0, max = 255, alpha = 100, names = "red"),
rgb(153, 25,0 , max = 255, alpha = 100, names = "yellow50"))
{
plot(tree.credit)
text(tree.credit, cex=0.8)
partition.tree(tree.credit, label = "", add = FALSE)
points(Credit$Rating,Credit$Balance, pch = 16, col = mycol[cat])
legend("bottomright", title = "Income",legend = c("0 - 21", "21 - 33", "33 - 57","57 - 186"), pch = 16, col = mycol, bty = "n")
}
mycol <- c(rgb(255, 193,69, max = 255, alpha = 100, names = "blue50"),
rgb(255, 102, 25, max = 255, alpha = 100, names = "green50"),
rgb(255, 0, 0, max = 255, alpha = 100, names = "red"),
rgb(153, 25,0 , max = 255, alpha = 100, names = "yellow50"))
{
plot(tree.credit)
text(tree.credit, cex=0.8)
partition.tree(tree.credit, label = "", add = FALSE)
points(Credit$Rating,Credit$Balance, pch = 16, col = mycol[cat])
legend("bottomright", title = "Income",legend = c("0 - 21", "21 - 33", "33 - 57","57 - 186"), pch = 16, col = mycol, bty = "n")
}
mycol <- c(rgb(255, 193,69, max = 255, alpha = 100, names = "blue50"),
rgb(255, 102, 25, max = 255, alpha = 100, names = "green50"),
rgb(255, 0, 0, max = 255, alpha = 100, names = "red"),
rgb(166, 27,0 , max = 255, alpha = 100, names = "yellow50"))
{
plot(tree.credit)
text(tree.credit, cex=0.8)
partition.tree(tree.credit, label = "", add = FALSE)
points(Credit$Rating,Credit$Balance, pch = 16, col = mycol[cat])
legend("bottomright", title = "Income",legend = c("0 - 21", "21 - 33", "33 - 57","57 - 186"), pch = 16, col = mycol, bty = "n")
}
mycol <- c(rgb(255, 193,69, max = 255, alpha = 100, names = "blue50"),
rgb(255, 102, 25, max = 255, alpha = 100, names = "green50"),
rgb(255, 0, 0, max = 255, alpha = 100, names = "red"),
rgb(166, 27,0 , max = 255, alpha = 100, names = "yellow50"))
{
plot(tree.credit)
text(tree.credit, cex=0.8)
partition.tree(tree.credit, label = "", add = FALSE)
points(Credit$Rating,Credit$Balance, pch = 16, col = mycol[cat])
legend("bottomright", title = "Income",legend = c("0 - 21", "21 - 33", "33 - 57","57 - 186"), pch = 16, col = mycol, bty = "n")
}
mycol <- c(rgb(255, 193,69, max = 255, alpha = 100, names = "blue50"),
rgb(255, 102, 25, max = 255, alpha = 100, names = "green50"),
rgb(255, 0, 0, max = 255, alpha = 100, names = "red"),
rgb(0, 27,0 , max = 255, alpha = 100, names = "yellow50"))
{
plot(tree.credit)
text(tree.credit, cex=0.8)
partition.tree(tree.credit, label = "", add = FALSE)
points(Credit$Rating,Credit$Balance, pch = 16, col = mycol[cat])
legend("bottomright", title = "Income",legend = c("0 - 21", "21 - 33", "33 - 57","57 - 186"), pch = 16, col = mycol, bty = "n")
}
mycol <- c(rgb(255, 193,69, max = 255, alpha = 100, names = "blue50"),
rgb(255, 102, 25, max = 255, alpha = 100, names = "green50"),
rgb(255, 0, 0, max = 255, alpha = 100, names = "red"),
rgb(201, 33,0 , max = 255, alpha = 100, names = "yellow50"))
{
plot(tree.credit)
text(tree.credit, cex=0.8)
partition.tree(tree.credit, label = "", add = FALSE)
points(Credit$Rating,Credit$Balance, pch = 16, col = mycol[cat])
legend("bottomright", title = "Income",legend = c("0 - 21", "21 - 33", "33 - 57","57 - 186"), pch = 16, col = mycol, bty = "n")
}
mycol <- c(rgb(255, 193,69, max = 255, alpha = 100, names = "blue50"),
rgb(255, 102, 25, max = 255, alpha = 100, names = "green50"),
rgb(255, 0, 0, max = 255, alpha = 100, names = "red"),
rgb(201, 33,0 , max = 255, alpha = 130, names = "yellow50"))
{
plot(tree.credit)
text(tree.credit, cex=0.8)
partition.tree(tree.credit, label = "", add = FALSE)
points(Credit$Rating,Credit$Balance, pch = 16, col = mycol[cat])
legend("bottomright", title = "Income",legend = c("0 - 21", "21 - 33", "33 - 57","57 - 186"), pch = 16, col = mycol, bty = "n")
}
mycol <- c(rgb(255, 227,115, max = 255, alpha = 100, names = "blue50"),
rgb(255, 102, 25, max = 255, alpha = 100, names = "green50"),
rgb(255, 0, 0, max = 255, alpha = 100, names = "red"),
rgb(201, 33,0 , max = 255, alpha = 130, names = "yellow50"))
{
plot(tree.credit)
text(tree.credit, cex=0.8)
partition.tree(tree.credit, label = "", add = FALSE)
points(Credit$Rating,Credit$Balance, pch = 16, col = mycol[cat])
legend("bottomright", title = "Income",legend = c("0 - 21", "21 - 33", "33 - 57","57 - 186"), pch = 16, col = mycol, bty = "n")
}
mycol <- c(rgb(255, 227,115, max = 255, alpha = 130, names = "blue50"),
rgb(255, 102, 25, max = 255, alpha = 100, names = "green50"),
rgb(255, 0, 0, max = 255, alpha = 100, names = "red"),
rgb(201, 33,0 , max = 255, alpha = 130, names = "yellow50"))
{
plot(tree.credit)
text(tree.credit, cex=0.8)
partition.tree(tree.credit, label = "", add = FALSE)
points(Credit$Rating,Credit$Balance, pch = 16, col = mycol[cat])
legend("bottomright", title = "Income",legend = c("0 - 21", "21 - 33", "33 - 57","57 - 186"), pch = 16, col = mycol, bty = "n")
}
mycol <- c(rgb(255, 227,115, max = 255, alpha = 130, names = "blue50"),
rgb(255, 185, 64, max = 255, alpha = 100, names = "green50"),
rgb(255, 0, 0, max = 255, alpha = 100, names = "red"),
rgb(201, 33,0 , max = 255, alpha = 130, names = "yellow50"))
{
plot(tree.credit)
text(tree.credit, cex=0.8)
partition.tree(tree.credit, label = "", add = FALSE)
points(Credit$Rating,Credit$Balance, pch = 16, col = mycol[cat])
legend("bottomright", title = "Income",legend = c("0 - 21", "21 - 33", "33 - 57","57 - 186"), pch = 16, col = mycol, bty = "n")
}
mycol <- c(rgb(255, 227,115, max = 255, alpha = 130, names = "blue50"),
rgb(235, 164, 73, max = 255, alpha = 100, names = "green50"),
rgb(255, 0, 0, max = 255, alpha = 100, names = "red"),
rgb(201, 33,0 , max = 255, alpha = 130, names = "yellow50"))
{
plot(tree.credit)
text(tree.credit, cex=0.8)
partition.tree(tree.credit, label = "", add = FALSE)
points(Credit$Rating,Credit$Balance, pch = 16, col = mycol[cat])
legend("bottomright", title = "Income",legend = c("0 - 21", "21 - 33", "33 - 57","57 - 186"), pch = 16, col = mycol, bty = "n")
}
mycol <- c(rgb(255, 227,115, max = 255, alpha = 130, names = "blue50"),
rgb(255, 126, 73, max = 255, alpha = 100, names = "green50"),
rgb(255, 0, 0, max = 255, alpha = 100, names = "red"),
rgb(201, 33,0 , max = 255, alpha = 130, names = "yellow50"))
{
plot(tree.credit)
text(tree.credit, cex=0.8)
partition.tree(tree.credit, label = "", add = FALSE)
points(Credit$Rating,Credit$Balance, pch = 16, col = mycol[cat])
legend("bottomright", title = "Income",legend = c("0 - 21", "21 - 33", "33 - 57","57 - 186"), pch = 16, col = mycol, bty = "n")
}
mycol <- c(rgb(255, 227,115, max = 255, alpha = 130, names = "blue50"),
rgb(255, 126, 73, max = 255, alpha = 130, names = "green50"),
rgb(255, 0, 0, max = 255, alpha = 100, names = "red"),
rgb(201, 33,0 , max = 255, alpha = 130, names = "yellow50"))
{
plot(tree.credit)
text(tree.credit, cex=0.8)
partition.tree(tree.credit, label = "", add = FALSE)
points(Credit$Rating,Credit$Balance, pch = 16, col = mycol[cat])
legend("bottomright", title = "Income",legend = c("0 - 21", "21 - 33", "33 - 57","57 - 186"), pch = 16, col = mycol, bty = "n")
}
mycol <- c(rgb(59, 122,87, max = 255, alpha = 130, names = "blue50"),
rgb(255, 227,115, max = 255, alpha = 130, names = "green50"),
rgb(255, 0, 0, max = 255, alpha = 100, names = "red"),
rgb(201, 33,0 , max = 255, alpha = 130, names = "yellow50"))
{
plot(tree.credit)
text(tree.credit, cex=0.8)
partition.tree(tree.credit, label = "", add = FALSE)
points(Credit$Rating,Credit$Balance, pch = 16, col = mycol[cat])
legend("bottomright", title = "Income",legend = c("0 - 21", "21 - 33", "33 - 57","57 - 186"), pch = 16, col = mycol, bty = "n")
}
mycol <- c(rgb(30, 179,0, max = 255, alpha = 130, names = "blue50"),
rgb(255, 227,115, max = 255, alpha = 130, names = "green50"),
rgb(255, 0, 0, max = 255, alpha = 100, names = "red"),
rgb(201, 33,0 , max = 255, alpha = 130, names = "yellow50"))
{
plot(tree.credit)
text(tree.credit, cex=0.8)
partition.tree(tree.credit, label = "", add = FALSE)
points(Credit$Rating,Credit$Balance, pch = 16, col = mycol[cat])
legend("bottomright", title = "Income",legend = c("0 - 21", "21 - 33", "33 - 57","57 - 186"), pch = 16, col = mycol, bty = "n")
}
mycol <- c(rgb(30, 179,0, max = 255, alpha = 130, names = "blue50"),
rgb(255, 227,115, max = 255, alpha = 130, names = "green50"),
rgb(255, 0, 0, max = 255, alpha = 100, names = "red"),
rgb(190, 33,0 , max = 255, alpha = 130, names = "yellow50"))
{
plot(tree.credit)
text(tree.credit, cex=0.8)
partition.tree(tree.credit, label = "", add = FALSE)
points(Credit$Rating,Credit$Balance, pch = 16, col = mycol[cat])
legend("bottomright", title = "Income",legend = c("0 - 21", "21 - 33", "33 - 57","57 - 186"), pch = 16, col = mycol, bty = "n")
}
mycol <- c(rgb(30, 179,0, max = 255, alpha = 130, names = "blue50"),
rgb(255, 227,115, max = 255, alpha = 130, names = "green50"),
rgb(255, 0, 0, max = 255, alpha = 100, names = "red"),
rgb(128, 33,0 , max = 255, alpha = 130, names = "yellow50"))
{
plot(tree.credit)
text(tree.credit, cex=0.8)
partition.tree(tree.credit, label = "", add = FALSE)
points(Credit$Rating,Credit$Balance, pch = 16, col = mycol[cat])
legend("bottomright", title = "Income",legend = c("0 - 21", "21 - 33", "33 - 57","57 - 186"), pch = 16, col = mycol, bty = "n")
}
mycol <- c(rgb(30, 179,0, max = 255, alpha = 130, names = "blue50"),
rgb(255, 227,115, max = 255, alpha = 130, names = "green50"),
rgb(255, 0, 0, max = 255, alpha = 100, names = "red"),
rgb(128, 0,20 , max = 255, alpha = 130, names = "yellow50"))
{
plot(tree.credit)
text(tree.credit, cex=0.8)
partition.tree(tree.credit, label = "", add = FALSE)
points(Credit$Rating,Credit$Balance, pch = 16, col = mycol[cat])
legend("bottomright", title = "Income",legend = c("0 - 21", "21 - 33", "33 - 57","57 - 186"), pch = 16, col = mycol, bty = "n")
}
mycol <- c(rgb(30, 179,0, max = 255, alpha = 130, names = "blue50"),
rgb(255, 227,115, max = 255, alpha = 130, names = "green50"),
rgb(255, 0, 0, max = 255, alpha = 100, names = "red"),
rgb(128, 0,20 , max = 255, alpha = 130, names = "yellow50"))
{
plot(tree.credit)
text(tree.credit, cex=0.8)
partition.tree(tree.credit, label = "", add = FALSE)
points(Credit$Rating,Credit$Balance, pch = 16, col = mycol[cat])
legend("bottomright", title = "Income",legend = c("0 - 21", "21 - 33", "33 - 57","57 - 186"), pch = 16, col = mycol, bty = "n")
}
mycol <- c(rgb(30, 179,0, max = 255, alpha = 130, names = "blue50"),
rgb(255, 227,115, max = 255, alpha = 130, names = "green50"),
rgb(255, 0, 0, max = 255, alpha = 100, names = "red"),
rgb(128, 0,40 , max = 255, alpha = 130, names = "yellow50"))
{
plot(tree.credit)
text(tree.credit, cex=0.8)
partition.tree(tree.credit, label = "", add = FALSE)
points(Credit$Rating,Credit$Balance, pch = 16, col = mycol[cat])
legend("bottomright", title = "Income",legend = c("0 - 21", "21 - 33", "33 - 57","57 - 186"), pch = 16, col = mycol, bty = "n")
}
partition.tree(tree.credit, label = "", add = FALSE, cex= 1.5)
points(Credit$Rating,Credit$Balance, pch = 16, col = mycol[cat])
{
plot(tree.credit)
text(tree.credit, cex=0.8)
partition.tree(tree.credit, label = "", add = FALSE, cex= 1.5)
points(Credit$Rating,Credit$Balance, pch = 16, col = mycol[cat])
legend("bottomright", title = "Income",legend = c("0 - 21", "21 - 33", "33 - 57","57 - 186"), pch = 16, col = mycol, bty = "n")
}
{
plot(tree.credit)
text(tree.credit, cex=0.8)
partition.tree(tree.credit, label = "", add = FALSE, cex= 1.2)
points(Credit$Rating,Credit$Balance, pch = 16, col = mycol[cat])
legend("bottomright", title = "Income",legend = c("0 - 21", "21 - 33", "33 - 57","57 - 186"), pch = 16, col = mycol, bty = "n")
}
mycol <- c(rgb(64, 128,0, max = 255, alpha = 130, names = "blue50"),
rgb(255, 227,115, max = 255, alpha = 130, names = "green50"),
rgb(255, 0, 0, max = 255, alpha = 100, names = "red"),
rgb(128, 0,40 , max = 255, alpha = 130, names = "yellow50"))
{
plot(tree.credit)
text(tree.credit, cex=0.8)
partition.tree(tree.credit, label = "", add = FALSE, cex= 1.2)
points(Credit$Rating,Credit$Balance, pch = 16, col = mycol[cat])
legend("bottomright", title = "Income",legend = c("0 - 21", "21 - 33", "33 - 57","57 - 186"), pch = 16, col = mycol, bty = "n")
}
mycol <- c(rgb(64, 128,0, max = 255, alpha = 130, names = "blue50"),
rgb(255, 227,115, max = 255, alpha = 130, names = "green50"),
rgb(255, 0, 0, max = 255, alpha = 100, names = "red"),
rgb(0, 85,225 , max = 255, alpha = 130, names = "yellow50"))
{
plot(tree.credit)
text(tree.credit, cex=0.8)
partition.tree(tree.credit, label = "", add = FALSE, cex= 1.2)
points(Credit$Rating,Credit$Balance, pch = 16, col = mycol[cat])
legend("bottomright", title = "Income",legend = c("0 - 21", "21 - 33", "33 - 57","57 - 186"), pch = 16, col = mycol, bty = "n")
}
plot(Credit$Rating,Credit$Balance, pch = 16, col = mycol[cat])
legend("bottomright", title = "Income",
legend = c("0 - 21", "21 - 33", "33 - 57","57 - 186"),
pch = 16, col = mycol, bty = "n")
plot(Credit$Rating,Credit$Balance, pch = 16, col = mycol[cat],
xlab = "Rating", ylab = "Balance")
legend("bottomright", title = "Income",
legend = c("0 - 21", "21 - 33", "33 - 57","57 - 186"),
pch = 16, col = mycol, bty = "n")
plot(tree.credit)
text(tree.credit, cex=0.8)
require(automap)
install.packages("automap")
?gridded
install.packages("gridded")
require(automap)
data(meuse)
coordinates(meuse) = ~x + y
coordinates(meuse)
data(meuse.grid)
gridded(meuse.grid) = ~x + y
autoKrige(zinc ~ soil + ffreq + dist, meuse, meuse.grid)
# Load Libraries ---------
{
library(tidyverse)
library(ranger)
library(caret)
library(mgcv)
library(gbm)
library(reshape2)
library(dplyr)
library(tidyverse)
library(randomForest)
library(skimr)
}
rm(list = ls())
setwd("/Users/chloestipinovich/Documents/2020/Thesis Project/grass-pollen")
# Read in data ----------
data      = read.csv("Final_Data/data_complete.csv")
data      = as.data.frame(data)
names(data)
head(data)
data      = dplyr::select(data, -File.Name, -Dataset, -aid, -Variance)
data      = rename(data,  VI_count = Count, VI_minimum = Minimum, VI_maximum = Maximum,
VI_range = Range, VI_mean = Mean, VI_sd = Standard.Deviation,
VI_UQ = Upper.Quartile,VI_U1.5.IQR = Upper.1.5.IQR, VI_L1.5.IQR = Lower.1.5.IQR,
VI_LQ = Lower.Quartile)
names(data)
data %>%
group_by(fyear) %>%
summarise(no_rows = length(fyear))
data$date = as.Date(data$date )
ggpubr::ggarrange(pollen, vi_max, ncol = 1)
train      = data[which(data$fyear=="2011"|data$fyear=="2012"|data$fyear=="2013"),]
validation = data[which(data$fyear=="2014"),]
nrow(validation)
skim(validation)
test       = data[which(data$fyear=="2018"),]
models_RMSE               = matrix(NA, nrow = 5, ncol = 3)
models_accuracy           = matrix(NA, ncol = 4, nrow = 5)
colnames(models_RMSE)     = c("Total", "In Season", "Out of Season")
colnames(models_accuracy) = c("Accuracy for Reg to cats", "Accuracy straight to cats", "In Season","Out of Season")
# pdf("1 Year Counts.pdf", width=10, height=7)
plot(validation$pollen_count, type = 'l', xlab = "Days Since 1 January",
ylab = "Pollen Count")
# Regression Models -----------
# Model 1; no veg index, no lags. Just weather data, ds and in/out seasin
# 1.1 Reg Model ----------
{
M1_Reg_Data = dplyr::select(train, -logvalue, -date, - pollen_cat, -X,
-veg_index, - VI_count, - VI_minimum, - VI_maximum,
- VI_range, -VI_mean, - VI_sd, - VI_UQ,
-VI_U1.5.IQR, -veg_index, -VI_L1.5.IQR, -VI_LQ, -visibility) #%>%
rf_grid    = expand.grid(mtry = 10:15,
splitrule = 'variance',
min.node.size = 5) #Default for regression is 5. Controls tree size.
ctrl       = trainControl(method = 'oob', verboseIter = T)
M1_Reg     = train(pollen_count ~ .,
data = M1_Reg_Data,
method = 'ranger',
num.trees = 2000,
verbose = T,
importance = 'impurity',
trControl = ctrl,
set.seed(2020),
tuneGrid = rf_grid) #Here is the grid
}
plot(varImp(M1_Reg))
yhat           = predict(M1_Reg, validation)
y              = validation$pollen_count
(models_RMSE[1,1] = mean((y - yhat)^2))
res <- residuals(naive(yhat))
install.packages("modeest")
# 10.81856
library(modeest)
res <- residuals(naive(yhat))
library(httr)
library(readr)
library(jsonlite)
r <- GET("https://modis.ornl.gov/rst/api/v1/MOD13Q1V006/dates?latitude=-33.9345&longitude=18.4771")
dates <- content(r)$dates
r <- GET("https://modis.ornl.gov/rst/api/v1/MOD13Q1/dates?latitude=-33.9345&longitude=18.4771")
dates <- content(r)$dates
modis_dates <- lapply(dates, function(dt) dt$modis_date)
calendar_dates <- lapply(dates, function(dt) dt$calendar_date)
# Print the first ten MODIS dates
dates[1:10]
modis_dates
daysVI <- lapply(dates, function(dt) dt$_250m_16_days_EVI)
?v
?MODISSubsets
install.packages("MODISSubsets")
library(MODISSubsets)
install.packages("MODISSubsets")
install.packages("MODISSubsets")
install.packages("MODIStools")
install.packages("MODISTools")
library(MODISTools)
MODISSubsets(LoadDat = PREDICTS,
Products = "MOD13Q1",
Bands = c("250m_16_days_EVI",
"250m_16_days_VI_Quality"),
Size = c(3,3),StartDate = FALSE, TimeSeriesLength = 1)
library(MODISTools)
library(MODISTools)
MODISSubsets(LoadDat = PREDICTS,
Products = "MOD13Q1",
Bands = c("250m_16_days_EVI",
"250m_16_days_VI_Quality"),
Size = c(3,3),StartDate = FALSE, TimeSeriesLength = 1)
MODISTools::MODISSubsets(LoadDat = PREDICTS,
Products = "MOD13Q1",
Bands = c("250m_16_days_EVI",
"250m_16_days_VI_Quality"),
Size = c(3,3),StartDate = FALSE, TimeSeriesLength = 1)
library(MODISTools)
